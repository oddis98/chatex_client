(this.webpackJsonpchatex2=this.webpackJsonpchatex2||[]).push([[0],{267:function(e,t,n){},268:function(e,t,n){},375:function(e,t){},377:function(e,t){},387:function(e,t){},389:function(e,t){},414:function(e,t){},415:function(e,t){},420:function(e,t){},422:function(e,t){},429:function(e,t){},448:function(e,t){},467:function(e,t,n){},499:function(e,t){},504:function(e,t,n){},505:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),r=n(18),a=n.n(r),s=(n(267),n(268),n(531)),o=n(40),l=n(2),d=function(e){var t=e.handleChange,n=e.values,i=e.errors,c=e.isValid;return Object(l.jsxs)(o.a,{children:[Object(l.jsx)("div",{children:i.email}),Object(l.jsx)("input",{type:"email",onChange:t,value:n.email,name:"email",placeholder:"Email"}),Object(l.jsx)("input",{type:"password",onChange:t,value:n.password,name:"password",placeholder:"Password"}),Object(l.jsx)("button",{id:"create",disabled:!c,children:"Create Account"})]})},u=n(43),h=u.a().shape({password:u.b().min(2,"Too Short!").max(50,"Too Long!").required("Required"),email:u.b().email("Invalid email").required("Required")}),j=n(11),f=n(255),b=n(369),m=function(e){var t=Object(j.f)();return Object(l.jsxs)("div",{id:"mainGrid",children:[Object(l.jsx)(f.a,{variant:"h1",children:"Create an Account"}),Object(l.jsxs)("div",{className:"signup",children:[Object(l.jsx)(o.b,{component:d,initialValues:{email:"",password:""},validationSchema:h,onSubmit:function(e){!function(e,t){var n=b.hashSync(t,b.genSaltSync()),i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.toLowerCase(),password:n})};fetch("/users",i).then((function(e){return e.json()})).then((function(e){if(!e.success)return alert(e.msg);alert("User: "+e.user.email+" created successfully!")}))}(e.email,e.password)}}),Object(l.jsx)("button",{id:"cancel",onClick:function(){t.push({pathname:"/home"})},children:"Cancel"})]})]})};var O=function(){return Object(l.jsx)(s.a,{container:!0,children:Object(l.jsx)(s.a,{item:!0,xs:12,align:"center",children:Object(l.jsx)(m,{})})})},p=n(12);var x=function(){var e=Object(i.useState)(0),t=Object(p.a)(e,2),n=t[0],c=t[1];Object(i.useEffect)((function(){return r()}));var r=function(){fetch("/users").then((function(e){return e.json()})).then((function(e){var t,n="";for(t=0;t<e.users.length;t++)n+=e.users[t].email+" ";return c(JSON.stringify(n))}))};return Object(l.jsx)(s.a,{container:!0,align:"center",id:"main",children:Object(l.jsxs)(s.a,{item:!0,children:[Object(l.jsx)(f.a,{variant:"h3",children:"All Users:"}),Object(l.jsx)(f.a,{variant:"h5",children:n})]})})},g=n(254),v=n(541),y=n(542),S=n(37),C=(n(467),function(e){var t=e.handleChange,n=e.values,i=e.errors,c=e.isValid;return Object(l.jsxs)(o.a,{children:[Object(l.jsx)("div",{children:i.email}),Object(l.jsx)("input",{type:"email",onChange:t,value:n.email,name:"email",placeholder:"Email"}),Object(l.jsx)("input",{type:"password",onChange:t,value:n.password,name:"password",placeholder:"Password"}),Object(l.jsx)("button",{disabled:!c,children:"Login"})]})}),w=u.a().shape({password:u.b().min(2,"Too Short!").max(50,"Too Long!").required("Required"),email:u.b().email("Invalid email").required("Required")}),k=function(e){var t=function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password})};fetch("/users/email/"+e.email).then((function(e){return e.json()})).then((function(e){try{var i=e.user._id,c=e.user.email;fetch("/login/"+i,t).then((function(e){return e.json()})).then((function(e){if(!e.success)return alert(e.msg);n(i,e.authorization,c)}))}catch(r){alert("No user with that email")}}))},n=function(e,t,n){c.push("/users/"+e)},c=Object(j.f)(),r=function(){c.push({pathname:"/https://oddis98.github.io/create"})};Object(i.useEffect)((function(){return fetch("/login").then((function(e){return e.json()})).then((function(e){e.success&&c.push("/https://oddis98.github.io/users/"+e.id)})),function(){}}));return Object(l.jsxs)("div",{id:"mainGrid",children:[Object(l.jsx)("h2",{children:"ChatEx"}),Object(l.jsxs)("div",{className:"signup",children:[Object(l.jsx)(o.b,{component:C,initialValues:{email:"",password:""},validationSchema:w,onSubmit:t}),Object(l.jsx)("button",{id:"create",onClick:r,children:"Create Account"})]})]})},T=function(){return Object(l.jsx)(s.a,{container:!0,children:Object(l.jsx)(s.a,{item:!0,xs:12,align:"center",children:Object(l.jsx)(k,{})})})},E=n(537),N=n(543),F=n(532),I=n(533),B=n(534),A=n(535),R=n(536),L=n(248),P=n.n(L),q=function(e){var t=e.onClose,n=e.open,c=e.getFriends,r=Object(i.useState)(""),a=Object(p.a)(r,2),s=a[0],o=a[1];return Object(l.jsx)(N.a,{onClose:function(){t()},"aria-labelledby":"addFriend",open:n,id:"outerDialog",children:Object(l.jsxs)("div",{style:{background:"#2d2d2d",borderRadius:"1rem",padding:"1rem",width:"20rem"},children:[Object(l.jsx)(F.a,{id:"addFriend",style:{},children:"Add a Friend!"}),Object(l.jsxs)(I.a,{children:[Object(l.jsx)(B.a,{children:Object(l.jsx)("input",{className:"friendInput",onChange:o,placeholder:"Write in your friend's E-mail!"})}),Object(l.jsx)(A.a,{children:Object(l.jsx)(R.a,{variant:"contained",onClick:function(){!function(){try{var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({friend:s.target.value.toLowerCase()})};fetch("/users/addFriend",e).then((function(e){return e.json()})).then((function(e){if(!e.success)return alert("No email found");c()}))}catch(t){console.log("Please type in a name")}}(),t()},style:{backgroundColor:"#8eff8b"},children:"Add friend"})})]})]})})},J=function(e){var t=Object(i.useState)(!1),n=Object(p.a)(t,2),c=n[0],r=n[1],a=e.getFriends;return Object(l.jsxs)("div",{style:{width:"3rem",height:"3rem"},children:[Object(l.jsx)(E.a,{onClick:function(){r(!0)},style:{color:"#ffffff"},children:Object(l.jsx)(P.a,{})}),Object(l.jsx)(q,{getFriends:a,open:c,onClose:function(){r(!1)}})]})},z=n(251),U=n.n(z),V=n(249),M=n.n(V),_=n(250),D=n.n(_),G=n(469),H=function(e){var t=Object(i.useState)([{"It's so quiet in here...":["","","#ffffff"]},{"Try adding a friend by clicking the '+' button under 'Friends', or invite an existing friend by clicking on their respective e-mail!":["","","#ffffff"]},{"You may also remove a friend by clicking the 'x' button next to their e-mail.":["","","#ffffff"]}]),n=Object(p.a)(t,2),c=n[0],r=n[1],a=Object(i.useState)("Scroll to Top \u2191"),s=Object(p.a)(a,2),o=s[0],d=s[1],u=Object(i.useRef)(),h=Object(i.useRef)();Object(i.useEffect)((function(){var t=function(){var t={method:"GET",headers:{"Content-Type":"application/json",authorization:"Bearer "+e.auth}};fetch("/room/"+e.room,t).then((function(e){return e.json()})).then((function(t){var n,i=[];try{for(n=0;n<t.conversation.length;n++){var a={},s=[],o=void 0,l=void 0;s.push(t.conversation[n].postedByUser.email),t.conversation[n].postedByUser.email===e.email?(o="right",l="#94e4f5"):(o="",l="#ffffff"),s.push(o),s.push(l),a[t.conversation[n].message.messageText]=s,i.push(a)}c!==i&&r(i),u.current.scrollIntoView({behavior:"smooth"})}catch(d){console.log(d)}}))};if(e.room){t();var n=G("ws://chatex2.herokuapp.com/");n.on("message",(function(e){t()}))}return function(){e.room&&n.disconnect()}}),[e.room,e.auth,e.email]);var j=/[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;return Object(l.jsx)("div",{id:"paperField",className:"innerMessage",style:{maxHeight:"calc(100vh - 12rem)",overflow:"auto",backgroundColor:""},children:Object(l.jsxs)("div",{id:"textBox",children:[Object(l.jsx)("div",{id:"dummyTop",ref:h}),Object(l.jsx)("ul",{children:c.map((function(e,t){var n=Object.keys(e),i=Object.values(e)[0][1],c=Object.values(e)[0][2],r=Object.values(e)[0][0];return Object(l.jsxs)("li",{style:{margin:"0.5rem",listStyle:"none",textAlign:i},children:[Object(l.jsx)("div",{style:{borderRadius:"1rem",backgroundColor:c,display:"inline-block",padding:"0.5rem",textAlign:"left",whiteSpace:"pre-line"},children:j.test(n)?Object(l.jsx)("a",{href:n[0].includes("http")?n:"//"+n,target:"_blank",rel:"noreferrer",style:{color:"#2d2d2d"},children:n}):n}),Object(l.jsx)("div",{style:{color:"rgba(255,255,255,0.3)",textAlign:i},children:r})]},t)}))}),Object(l.jsx)("div",{children:Object(l.jsx)("p",{style:{position:"fixed",right:50,bottom:"6rem",color:"#ffffff",cursor:"pointer"},onClick:function(){document.querySelector("#dummyTop").getBoundingClientRect().top<0?(h.current.scrollIntoView({behavior:"smooth"}),d("Scroll to Current \u2193")):(u.current.scrollIntoView({behavior:"smooth"}),d("Scroll to Top \u2191"))},children:o})}),Object(l.jsx)("div",{ref:u})]})})},W=function(){var e=Object(i.useState)(""),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(i.useState)(""),a=Object(p.a)(r,2),o=a[0],d=a[1],u=Object(i.useState)(""),h=Object(p.a)(u,2),f=h[0],b=h[1],m=Object(i.useState)(""),O=Object(p.a)(m,2),x=O[0],g=O[1],v=Object(i.useState)(""),y=Object(p.a)(v,2),S=y[0],C=y[1],w=Object(i.useState)([]),k=Object(p.a)(w,2),T=k[0],N=k[1],F=Object(i.useState)(""),I=Object(p.a)(F,2),B=I[0],A=I[1],R=Object(j.f)(),L=function(e){try{fetch("/users/email/"+e.target.textContent).then((function(e){return e.json()})).then((function(t){if(t.success){var n={method:"POST",headers:{"Content-Type":"application/json",authorization:"Bearer "+o},body:JSON.stringify({userIds:[f,t.user._id],type:"consumer-to-consumer"})};fetch("/room/initiate",n).then((function(e){return e.json()})).then((function(t){g(t.chatRoom.chatRoomId),A(e.target.textContent)}))}}))}catch(t){console.log(t)}},P=function(){try{var e=S.target.value,t={method:"POST",headers:{"Content-Type":"application/json",authorization:"Bearer "+o},body:JSON.stringify({messageText:e})};fetch("/room/"+x+"/message",t).then((function(e){return e.json()})).then((function(e){e.success}))}catch(n){console.log("Not connected")}};Object(i.useEffect)((function(){return fetch("/login").then((function(e){return e.json()})).then((function(e){e.success?(c(e.email),d(e.auth),b(e.id)):R.push("/https://oddis98.github.io/")})),document.getElementById("msgBox").addEventListener("keyup",(function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),document.getElementById("sendMessage").click())})),q(),function(){}}),[R]);var q=function(){try{fetch("/users/friends/allFriends").then((function(e){return e.json()})).then((function(e){var t=[];if(e.user){for(var n=0;n<e.user.friendList.length;n++)t.push(e.user.friendList[n]);N(t)}}))}catch(e){console.log("Friendlist empty")}},z=function(e){var t=e.target.parentElement.parentElement.parentElement.parentElement.parentElement.textContent;try{var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({friend:t})};fetch("/users/removeFriend",n).then((function(e){return e.json()})).then((function(e){q()}))}catch(i){console.log("oh no")}};return Object(l.jsxs)(s.a,{container:!0,className:"main",children:[Object(l.jsx)(s.a,{item:!0,className:"info",style:{borderRight:"2px solid #3a3a3a"},children:Object(l.jsxs)("div",{className:"infoDiv",children:[Object(l.jsx)("h2",{className:"infoHeader",children:"ChatEx"}),Object(l.jsx)("h4",{style:{color:"#ffffff",fontSize:"1rem",padding:"1rem"},children:"Friends:"}),Object(l.jsx)(J,{getFriends:q}),Object(l.jsx)("div",{id:"friendList",style:{maxHeight:"40vh",overflow:"auto",width:"100%"},children:Object(l.jsx)("ul",{style:{display:"flex",flexWrap:"wrap"},children:T.map((function(e,t){return Object(l.jsx)("li",{style:{listStyle:"none",textAlign:"left",margin:"0.5rem 0.5rem",width:"100%"},children:Object(l.jsxs)("div",{style:{backgroundColor:"#2f2f2f",border:"1px solid black",borderRadius:"1rem",padding:"0.5rem",color:"#fff",display:"flex",flexWrap:"wrap",alignItems:"center"},children:[Object(l.jsx)("div",{onClick:L,style:{cursor:"pointer",flexGrow:"1"},children:e}),Object(l.jsx)("div",{style:{},onClick:z,children:Object(l.jsx)(E.a,{style:{width:"1rem",height:"1rem",paddingLeft:"1rem",color:"#ffffff"},children:Object(l.jsx)(M.a,{})})})]})},t)}))})}),Object(l.jsx)(E.a,{onClick:function(){fetch("/logout").then((function(e){return e.json()})).then((function(e){e.success&&R.push("/https://oddis98.github.io")}))},id:"logout",children:Object(l.jsx)(D.a,{})})]})}),Object(l.jsxs)(s.a,{item:!0,className:"messageBoard",children:[Object(l.jsx)(H,{auth:o,room:x,email:n,friend:B}),Object(l.jsxs)("div",{className:"button",children:[Object(l.jsx)("textarea",{id:"msgBox",className:"messageInput",onChange:C,placeholder:"Write something cool!"}),Object(l.jsx)(E.a,{id:"sendMessage",variant:"contained",onClick:function(){P(),document.getElementById("msgBox").value=""},children:Object(l.jsx)(U.a,{})})]})]})]})},Z=(n(504),n(65)),Y=function(){Object(i.useEffect)((function(){for(var t=document.querySelector(".container"),n=0;n<=30;n++){var i=document.createElement("div");i.classList.add("block"),t.appendChild(i)}return e(),function(){}}));var e=function e(){Object(Z.a)({targets:".block",translateX:function(){return Z.a.random(-1200,1200)},translateY:function(){return Z.a.random(-500,500)},scale:function(){return Z.a.random(1,5)},easing:"linear",duration:1e4,delay:Z.a.stagger(10),complete:e})};return Object(l.jsxs)("div",{className:"container",children:[Object(l.jsx)("h2",{children:"ChatEx"}),Object(l.jsx)("h2",{id:"subText",children:"Free. Private. Simple."})]})},X=n(538),K=n(539),Q=n(540),$=n(253),ee=n.n($),te=n(252),ne=n.n(te),ie=Object(X.a)((function(e){return{nav:{background:"rgba(0,0,0,1)"}}})),ce=function(){var e=ie();return Object(l.jsx)(K.a,{className:e.nav,children:Object(l.jsxs)(Q.a,{children:[Object(l.jsx)("span",{className:"item"}),Object(l.jsx)(S.b,{exact:!0,to:"/home",className:"link",children:Object(l.jsx)(ne.a,{})}),Object(l.jsx)(S.b,{exact:!0,to:"/",className:"link",children:Object(l.jsx)(ee.a,{})})]})})};var re=function(){var e=Object(g.a)({palette:{type:"light",primary:{main:"#94E4F5",contrastText:"#000"},secondary:{main:"#ffffff",contrastText:"#fff"}},typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")}});return Object(l.jsxs)(v.a,{theme:e,children:[Object(l.jsx)(y.a,{}),Object(l.jsxs)(S.a,{children:[Object(l.jsx)(ce,{}),Object(l.jsxs)(j.c,{children:[Object(l.jsx)(j.a,{exact:!0,path:"/https://oddis98.github.io",children:Object(l.jsx)(Y,{})}),Object(l.jsx)(j.a,{exact:!0,path:"/https://oddis98.github.io/home",children:Object(l.jsx)(T,{})}),Object(l.jsx)(j.a,{exact:!0,path:"/https://oddis98.github.io/create",children:Object(l.jsx)(O,{})}),Object(l.jsx)(j.a,{exact:!0,path:"/https://oddis98.github.io/users",children:Object(l.jsx)(x,{})}),Object(l.jsx)(j.a,{path:"/https://oddis98.github.io/users/:id",children:Object(l.jsx)(W,{})})]})]})]})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,544)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),c(e),r(e),a(e)}))};a.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(re,{})}),document.getElementById("root")),ae()}},[[505,1,2]]]);
//# sourceMappingURL=main.c055ac33.chunk.js.map